sudo: required
language: go
go:
- 1.7
before_install:
- sudo apt-get install zip
- go get github.com/tools/godep
- go get -d github.com/stretchr/testify/assert
install:
- godep restore
script:
- go test -v ./...
- mkdir linux_amd64
- mkdir windows_amd64
- go build  -o ./linux_amd64/blobporter github.com/Azure/blobporter
- export GOOS=windows
- go build  -o ./windows_amd64/BlobPorter.exe github.com/Azure/blobporter
- md5sum ./linux_amd64/blobporter > ./linux_amd64/blobporter.md5
- md5sum ./windows_amd64/BlobPorter.exe > ./windows_amd64/BlobPorter.exe.md5
- tar cvzf bp_linux.tar.gz linux_amd64
- zip bp_windows.zip ./windows_amd64/*
- bash inttest.sh inttest
deploy:
  provider: releases
  api_key:
    secure: BioZ/BRul81bKAUVGa2nmnV43boG6050dLUMyXsM15UDPfvvCo7+REpNELHA874y9qaULESTzfjGynEVvXvNb4HlaPc9KJobIW7orRqd/5u0ech/MhNB5S+7epAOC22Hw9drITyPlfggxUI/L36KN14CggShQTk28B3pejhdJpz2OBb7KXEgY9W33E0F0QBXnZVS66yXaWP7JWv4kXH6R0U3Pf2DsMtsuVhj88admJqIwdQnusNV/atB8EEPkPhMgDvztNVEGmKJxC89Wo7jeFVqafW/t/Z4TJxCHDM0Kg89Cbq+9875ZFG4eir99ovgGfw2CtkZuMNZW9zuzN7UDxrCYVcmcRYAbGWzh4v2KovEqrGD68M2fYXK5X+WNGbudQy4WtFevLDJ/QLgO30uATCApoasvYqtfy7naqWcTmkpH3DbFrQW47b6gu5fVHQS0SW5VFzGkWzQ+P9Wt5/aalD/p0H7xg8ZuNvlngJczi0Vsa9s2uHunB/Ofcf5wa1DTMEHDsLkuYdqS70hu/H/MPViyJYQY1Pbr9ug5NRZ+MbA59tUaGvksk1bc+3yKaUEE9Z8ZbpopHzvHMD4sLTWlvregQvo9yuTG7fzXHKnHa+MEJl7MMe92mGkJtIz6NEQrx6KWw1EJoUI234vSi7cjt8Lm2r3WsXGKkNdw1JUb9I=
  file: 
    - bp_linux.tar.gz
    - bp_windows.zip
  on:
    repo: Azure/blobporter
    tags: true 

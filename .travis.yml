sudo: required
language: go
go:
- 1.7
before_install:
- sudo apt-get install zip
- go get github.com/tools/godep
- go get -d github.com/stretchr/testify/assert
install:
- godep restore
script:
- go test -v ./...
- mkdir linux_amd64
- mkdir windows_amd64
- go build  -o ./linux_amd64/blobporter github.com/Azure/blobporter
- export GOOS=windows
- go build  -o ./windows_amd64/BlobPorter.exe github.com/Azure/blobporter
- md5sum ./linux_amd64/blobporter > ./linux_amd64/blobporter.md5
- md5sum ./windows_amd64/BlobPorter.exe > ./windows_amd64/BlobPorter.exe.md5
- tar cvzf bp_linux.tar.gz linux_amd64
- zip bp_windows.zip ./windows_amd64/*
- bash inttest.sh inttest
deploy:
  provider: releases
  api_key:
    secure: P2XkTick8+5If53mw4WLiOsH/0HEPdAm60DkOMmAwSRrLH6z92POuQR9147mKIxxrHvjgOOXJ407ioVa6lTslW00CmPT7uq0hj5SFRjI4hDALLXoIpQrGyNUxFE9do2R5jG0aeQLqCUsrvfNaBS4UIDX1GxHVA2x8DeGGh50CUR2bkXXm+z8DNODuICIPdWnzgcnkR1s2DuL2NR5kW/8dk9/Dfhxn8oxVWX7/uU89u9v8ycQ5SEgmsMUjLC9BIxk+19FBwDsaRqGpsQoWzFJE9KoGkswmkufGaBSXB/doGKPPXs/Ol42ZdQy8YxdQqYflaRuSXvfpGnTSu8U6MsgPW6nu7vDq21YTFtM6qqRZTS4x66s9o/Wn7iVeVnnkvZOiOnoTqHRzPqFGvxQwaiOydnIhVfBPqKlG/Y0BjEKZpHhrh/nW20JbkVb7ScJhYiA7LHQgJKOXvhIp3iyIeCIN7IQ5XpNQ+JZJqsbzes63YjWmhVP2lk7JDTsiy9NhpdFqwq8mane2psGMa2lCF289mzXdC+WkGx+Z6HgAvKRzNbJkhySf7HPbcDBM4+GNS/nbM7gKPQXD78b7gq7dxPTN+xySEdqNylEhnwe/fuQKMswswybEhJ1fwtHrdQausU8WPAxib5th8Fx330mcKCO0QbAm2FGb67Tf8g8bBLyHsw=
  file: 
    - bp_linux.tar.gz
    - bp_windows.zip
  on:
    repo: Azure/blobporter
    tags: true 
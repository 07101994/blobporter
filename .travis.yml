sudo: required
language: go
go:
- 1.7
before_install:
- sudo apt-get install zip
- go get github.com/tools/godep
- go get -d github.com/stretchr/testify/assert
install:
- godep restore
script:
- go test -v ./...
- mkdir linux_amd64
- mkdir windows_amd64
- go build  -o ./linux_amd64/blobporter github.com/Azure/blobporter
- export GOOS=windows
- go build  -o ./windows_amd64/BlobPorter.exe github.com/Azure/blobporter
- md5sum ./linux_amd64/blobporter > ./linux_amd64/blobporter.md5
- md5sum ./windows_amd64/BlobPorter.exe > ./windows_amd64/BlobPorter.exe.md5
- tar cvzf bp_linux.tar.gz linux_amd64
- zip bp_windows.zip ./windows_amd64/*
- bash inttest.sh inttest
deploy:
  provider: releases
  api_key:
    secure: IJQWazKnfh5JQTiegmATLZ5d2hFKEoASolasshpNWdkEGCFMunBORCxlhUwu1Sy1Snu87fnqKROvE6qm4bCiUC58LKPAn08gdUbDbecj6dQJi/KW04W3vnoqD5bZzKW3JM+RyPpT9qCWjVSzsrUnL6FtPF9u0vV4aFqL6vnUbMirwLjvqz36DoBqZPDpyGLcraPFwsWLymmKEGN2egFaPq3hwxd56PZdETTlTqFrAyFbY/v0gyhD8Rwy2KJKgU0xaOypxc0duaVtCoIzPyy4IFOilLJg1e14k8EuQiIzYN7QxZpRjRxpM8slUb+xH4lmF90YhZ4Pm9gip4EzdcZEEFXaV/aCo+m7CqynQDGStaDZk0acmnQm2e4cODtP2UXz5vfaeRUGcfjgq4RsZaOIdjtItDyKFkEb7TBlAH8DMhV7TVlZnE7clpMxuABzVL6QoxJ5T0Oqb6v0A7YqobD2pa0yFUQNvCOLGetxhCDzMwglQAr80P8xbBtDEFWgX/srtXDrr1yQgX7GrZ5wa0PAEtmkLnV3zkhEKhyH/P4s8w2G2CNwq8IvxxSJhfLVGRSglBTqfqmpFf5L1ErS8WqixxVR171lqGlp3RelPOvAQnT85WSvizmWpLyd2PF5lYaTRR52mN3CfjHSqL077bh87Wrqs7xDwCOqzdra579nytw= 
  file: 
    - bp_linux.tar.gz
    - bp_windows.zip
  on:
    repo: Azure/blobporter
    tags: true 
